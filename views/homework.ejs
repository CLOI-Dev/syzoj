<% this.title = homework.name + ' - 作业' %>
<% include header %>
<div class="padding">
  <div class="ui grid">
    <div class="row">
      <div class="column">
        <h2 class="ui dividing header">
          <% if(homework.active) { %>
            <i class="flag icon"></i>
          <% } else { %>
            <i class="archive icon"></i>
          <% } %>
          <%= homework.name %></h2>
        
        <h3 class="ui dividing header"> 题目 </h3>
        <table class="ui very basic center aligned table">
          <thead>
            <tr>
              <th class="one wide" style="text-align: center">提交状态</th>
              <th class="one wide">编号</th>
              <th class="left aligned">题目</th>
              <th class="one wide">总通过数</th>
              <th class="one wide">总提交数</th>
              <th class="one wide">总通过率</th>
            </tr>
          </thead>
          <tbody>
            <% for (let problem of problems) { %>
            <tr style="height: 44px; ">
                <td>
                <% if (problem.judge_state) { %>
                  <a href="<%= syzoj.utils.makeUrl(['submission', problem.judge_state.id]) %>">
                    <span class="status <%= problem.judge_state.status.toLowerCase().split(' ').join('_') %>">
                      <i class="<%= icon[problem.judge_state.status] || 'remove' %> icon"></i>
                    </span>
                  </a>
                <% } %>
                </td>
                <td>
                  <%= problem.id %>
                </td>
                <td class="left aligned">
                  <a href="<%= syzoj.utils.makeUrl(['problem', problem.id]) %>" target="_blank"><%= syzoj.utils.removeTitleTag(problem.title) %></a>
                  <div class="show_tag_controled" style="float: right; ">
                      <%
                      if (problem.tags) {
                        for (let tag of problem.tags) {
                        %>
                        <span class="ui header">
                          <a class="ui tiny <%= tag.color %> label">
                            <%= tag.name %>
                          </a>
                        </span>
                        <%
                        }
                      }
                      %>
                    </div>
                </td>
                <td><%= problem.ac_num %></td>
                <td><%= problem.submit_num %></td>
                <td><%= problem.submit_num != 0 ? (((problem.ac_num / problem.submit_num * 100) || 0).toFixed(2) + '%') : '-' %></td>
            </tr>
            <% } %>
          </tbody>
        </table>
        
        <h3 class="ui dividing header"> 同学完成情况 </h3>
	<div style="overflow:auto;width:100%">
        <table width="auto" style="white-space:nowrap" class="ui celled table"> 
            <thead>
              <tr>
                <th class="one wide" style="text-align: center">姓名</th>
                <% for (let problem of problems) { %>
                  <th class="one wide"><%=problem.id%></th>
                <% } %>
              </tr>
            </thead>
            <tbody>
              <% for (let student of students) { %>
                <tr>
                  <td><%=student.username%></td>
                  <% for (let problem of problems) { %>
                    <% if(result[student.id][problem.id]) { %>
                      <td><%=result[student.id][problem.id].score%></td>  
                    <% } else { %>
                      <td> no submit </td>  
                    <% } %>
                  <% } %>
                <tr>
              <% } %>
            </tbody>
        </table>  
	</div>      
      </div>
    </div>
  </div>
</div>
<% include footer %>
